<?php/** * @package		Zentools * @version		v1.1 * @author		Joomlabamboo http://www.joomlabamboo.com * @copyright 	Copyright (C) 2007 - 2012 Joomla Bamboo * @license		http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 only */// no direct accessdefined('_JEXEC') or die('Restricted access');// Create a category selectorclass JFormFieldCategoriesmultiple extends JFormField {	protected	$type = 'categoriesmultiple';	protected function getInput(){		$db = &JFactory::getDBO();		$query = 'SELECT m.* FROM #__k2_categories m WHERE published=1 AND trash = 0 ORDER BY parent, ordering';		$db->setQuery( $query );		$mitems = $db->loadObjectList();		$children = array();		if ($mitems){			foreach ( $mitems as $v ){				$pt 	= $v->parent;				$list = @$children[$pt] ? $children[$pt] : array();				array_push( $list, $v );				$children[$pt] = $list;			}		}		$list = JHTML::_('menu.treerecurse', 0, '', array(), $children, 9999, 0, 0 );		$mitems = array();		foreach ( $list as $item ) {			$mitems[] = JHTML::_('select.option',  $item->id, '&nbsp;&nbsp;&nbsp;'.$item->treename );		}				$doc = & JFactory::getDocument();		$output= JHTML::_('select.genericlist',  $mitems, ''.$control_name.'['.$name.'][]', 'class="inputbox" style="width:90%;" multiple="multiple" size="10"', 'value', 'text', $value );		return $output;	}}